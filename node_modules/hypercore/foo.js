var hypercore = require('./')
var memdb = require('memdb')

var core1 = hypercore(memdb())
var core2 = hypercore(memdb())

var feed1 = core1.createFeed()
var feed2 = core2.createFeed(feed1.key)

feed1.append([
  'how',
  'are',
  'you',
  'doing?',
  'i',
  'am',
  'fine',
  'thanks',
  'what',
  'about',
  'you?'
])

feed1.flush(function () {
  console.log(feed1.blocks, feed1.bytes)

  var s1 = feed1.replicate()
  var s2 = feed2.replicate()

  s1.pipe(s2).pipe(s1)

  s1.on('end', function () {
    feed2.get(0, function (err, buf) {
      if (err) throw err
      console.log('->', buf.toString())
    })
  })
})
