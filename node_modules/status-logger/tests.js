// var util = require('util')
var test = require('tape')
var log = require('.')()

function hook_stdout (callback) {
  var old_write = process.stdout.write

  process.stdout.write = (function (write) {
    return function (string, encoding, fd) {
      write.apply(process.stdout, arguments)
      callback(string, encoding, fd)
    }
  })(process.stdout.write)

  return function () {
    process.stdout.write = old_write
  }
}

var output = ''

hook_stdout(function (string, encoding, fd) {
  console.error('here', string.indexOf('status_logger') > -1)
  if (string && string.indexOf('status_logger') > -1) output += string
  // else console.log(util.inspect(string))
})

test('prints message', function (t) {
  log.message('status_logger: test')
  t.ok(output)
  log.exit()
  // unhook()
  t.end()
})
